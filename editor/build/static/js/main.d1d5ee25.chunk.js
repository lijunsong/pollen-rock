(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{36:function(e,t,n){e.exports=n.p+"static/media/logo.b3e3bf7f.svg"},38:function(e,t,n){e.exports=n(87)},78:function(e,t,n){var a={"./apl/apl.js":[104,7],"./asciiarmor/asciiarmor.js":[105,8],"./asn.1/asn.1.js":[106,9],"./asterisk/asterisk.js":[107,10],"./brainfuck/brainfuck.js":[108,11],"./clike/clike.js":[93,2],"./clojure/clojure.js":[109,12],"./cmake/cmake.js":[110,13],"./cobol/cobol.js":[111,14],"./coffeescript/coffeescript.js":[94,15],"./commonlisp/commonlisp.js":[112,16],"./crystal/crystal.js":[113,17],"./css/css.js":[90,1],"./cypher/cypher.js":[114,18],"./d/d.js":[115,19],"./dart/dart.js":[116,2,20],"./diff/diff.js":[117,21],"./django/django.js":[118,0,1,114],"./dockerfile/dockerfile.js":[119,22],"./dtd/dtd.js":[120,23],"./dylan/dylan.js":[121,24],"./ebnf/ebnf.js":[122,25],"./ecl/ecl.js":[123,26],"./eiffel/eiffel.js":[124,27],"./elm/elm.js":[125,28],"./erlang/erlang.js":[126,29],"./factor/factor.js":[127,30],"./fcl/fcl.js":[128,31],"./forth/forth.js":[129,32],"./fortran/fortran.js":[130,33],"./gas/gas.js":[131,34],"./gfm/gfm.js":[132,3,35],"./gherkin/gherkin.js":[133,36],"./go/go.js":[134,37],"./groovy/groovy.js":[135,38],"./haml/haml.js":[136,0,1,116],"./handlebars/handlebars.js":[95,39],"./haskell-literate/haskell-literate.js":[137,41],"./haskell/haskell.js":[96,40],"./haxe/haxe.js":[138,42],"./htmlembedded/htmlembedded.js":[139,0,1,43],"./htmlmixed/htmlmixed.js":[89,0,1,44],"./http/http.js":[140,45],"./idl/idl.js":[141,46],"./javascript/javascript.js":[91,0],"./jinja2/jinja2.js":[142,47],"./jsx/jsx.js":[143,0,48],"./julia/julia.js":[144,49],"./livescript/livescript.js":[145,50],"./lua/lua.js":[146,51],"./markdown/markdown.js":[101,3],"./mathematica/mathematica.js":[147,52],"./mbox/mbox.js":[148,53],"./meta.js":[18],"./mirc/mirc.js":[149,54],"./mllike/mllike.js":[150,55],"./modelica/modelica.js":[151,56],"./mscgen/mscgen.js":[152,57],"./mumps/mumps.js":[153,58],"./nginx/nginx.js":[154,59],"./nsis/nsis.js":[155,60],"./ntriples/ntriples.js":[156,61],"./octave/octave.js":[157,62],"./oz/oz.js":[158,63],"./pascal/pascal.js":[159,64],"./pegjs/pegjs.js":[160,0,65],"./perl/perl.js":[161,120],"./php/php.js":[162,0,1,2,118],"./pig/pig.js":[163,66],"./powershell/powershell.js":[164,67],"./properties/properties.js":[165,68],"./protobuf/protobuf.js":[166,69],"./pug/pug.js":[102,0,1,5],"./puppet/puppet.js":[167,70],"./python/python.js":[97,71],"./q/q.js":[168,72],"./r/r.js":[169,73],"./rpm/rpm.js":[170,74],"./rst/rst.js":[171,115],"./ruby/ruby.js":[92,75],"./rust/rust.js":[172,76],"./sas/sas.js":[173,77],"./sass/sass.js":[99,1,78],"./scheme/scheme.js":[174,79],"./shell/shell.js":[175,80],"./sieve/sieve.js":[176,81],"./slim/slim.js":[177,0,1,117],"./smalltalk/smalltalk.js":[178,82],"./smarty/smarty.js":[179,83],"./solr/solr.js":[180,84],"./soy/soy.js":[181,0,1,119],"./sparql/sparql.js":[182,85],"./spreadsheet/spreadsheet.js":[183,86],"./sql/sql.js":[184,121],"./stex/stex.js":[98,87],"./stylus/stylus.js":[103,4],"./swift/swift.js":[185,88],"./tcl/tcl.js":[186,89],"./textile/textile.js":[187,90],"./tiddlywiki/tiddlywiki.js":[188,91],"./tiki/tiki.js":[189,92],"./toml/toml.js":[190,93],"./tornado/tornado.js":[191,0,1,94],"./troff/troff.js":[192,95],"./ttcn-cfg/ttcn-cfg.js":[194,97],"./ttcn/ttcn.js":[193,96],"./turtle/turtle.js":[195,98],"./twig/twig.js":[196,99],"./vb/vb.js":[197,100],"./vbscript/vbscript.js":[198,101],"./velocity/velocity.js":[199,102],"./verilog/verilog.js":[200,103],"./vhdl/vhdl.js":[201,104],"./vue/vue.js":[202,0,1,4,5,105],"./webidl/webidl.js":[203,106],"./xml/xml.js":[88,107],"./xquery/xquery.js":[204,108],"./yacas/yacas.js":[205,109],"./yaml-frontmatter/yaml-frontmatter.js":[206,111],"./yaml/yaml.js":[100,110],"./z80/z80.js":[207,112]};function r(e){var t=a[e];return t?Promise.all(t.slice(1).map(n.e)).then(function(){var e=t[0];return n.t(e,7)}):Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}r.keys=function(){return Object.keys(a)},r.id=78,e.exports=r},81:function(e,t,n){},83:function(e,t,n){},85:function(e,t,n){},87:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(22),o=n.n(i),s=n(5),c=n(6),l=n(8),u=n(7),h=n(9),d=n(3),p=n.n(d),f=n(11),v=n(23),m=n.n(v);function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var k=r.a.createElement("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),j=r.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"});n.p;function b(){return(b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var y=r.a.createElement("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),C=r.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"});n.p;function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var w=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),S=r.a.createElement("path",{d:"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"});n.p;function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var E=r.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),T=r.a.createElement("path",{d:"M3 19h18v-6H3v6zm0-8h18V9H3v2zm0-6v2h18V5H3z"});n.p;function A(){return(A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var F=r.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),B=r.a.createElement("path",{d:"M3 15h8v-2H3v2zm0 4h8v-2H3v2zm0-8h8V9H3v2zm0-6v2h8V5H3zm10 0h8v14h-8V5z"});n.p;function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var D=r.a.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),H=r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"});n.p;function P(e){return function(t){var n="icons";return t.className&&(n+=" ".concat(t.className)),r.a.createElement(e,Object.assign({},t,{className:n}))}}var M=P(function(e){return r.a.createElement("svg",g({width:24,height:24,viewBox:"0 0 24 24"},e),k,j)}),z=P(function(e){return r.a.createElement("svg",b({width:24,height:24,viewBox:"0 0 24 24"},e),y,C)}),L=P(function(e){return r.a.createElement("svg",O({width:24,height:24,viewBox:"0 0 24 24"},e),E,T)}),V=P(function(e){return r.a.createElement("svg",A({width:24,height:24,viewBox:"0 0 24 24"},e),F,B)}),R=P(function(e){return r.a.createElement("svg",x({width:24,height:24,viewBox:"0 0 24 24"},e),w,S)}),W=P(function(e){return r.a.createElement("svg",N({width:24,height:24,viewBox:"0 0 24 24"},e),D,H)}),I=n(16),q=n(14),U=n.n(q),G="";function _(e){var t="".concat(G,"/rest/fs/").concat(e);return U.a.get(t)}function J(e){e=e||"";var t="".concat(G,"/rest/config/").concat(e);return U.a.get(t)}function K(e){e=e||"";var t="".concat(G,"/rest/tags/").concat(e);return U.a.get(t)}function Z(e,t,n){return function(e,t){var n=[];for(var a in t)n.push(encodeURIComponent(a)+"="+encodeURIComponent(t[a]));var r=n.join("&");return U()({method:"POST",url:e,headers:{"content-type":"application/x-www-form-urlencoded"},data:r})}("".concat(G,"/rest/fs/").concat(e),{op:"write",data:t,mtime:n||0})}function Q(e){var t="".concat(G,"/rest/render/").concat(e);return U.a.get(t)}var X=n(12);function Y(e){return r.a.createElement(X.ToastContainer,Object.assign({},e,{className:"toastContainer",toastClassName:"toast",autoClose:!1,transition:X.Zoom}))}function $(){var e;(e=console).warn.apply(e,arguments),X.toast.warning.apply(X.toast,arguments)}function ee(){var e;(e=console).error.apply(e,arguments),X.toast.error.apply(X.toast,arguments)}function te(e){return r.a.createElement("div",{id:"NavHeader"},"Entries")}var ne=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={entries:Object(I.b)({"/":Object(I.a)(["Loading"])}),expanded:Object(I.c)(),selectedPath:null},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"onClickFile",value:function(e){this.props.onClickFile&&this.props.onClickFile(e),this.setState({selectedPath:e})}},{key:"onClickFolder",value:function(e){var t=this;if(this.state.expanded.has(e)){var n=this.state.expanded.delete(e);this.setState({expanded:n})}else this.fetchFileList(e).then(function(){var n=t.state.expanded.add(e);t.setState({expanded:n})})}},{key:"renderFolder",value:function(e,t){var n=m.a.join(e,t),a=r.a.createElement(z,{className:"textSizedIcons"}),i="";if(this.state.expanded.has(n)){var o=this.state.entries.get(n);i=r.a.createElement("div",{className:"entrySpacer"},this.renderEntryList(n,o)),a=r.a.createElement(M,{className:"textSizedIcons"})}var s=r.a.createElement("span",{className:"entry",onClick:this.onClickFolder.bind(this,n)},a,t);return r.a.createElement("div",{className:"isDir",key:n},s,i)}},{key:"renderFile",value:function(e,t){var n=["isFile","entry"],a=m.a.join(e,t);this.state.selectedPath===a&&n.push("selectedEntry"),a.endsWith(".html")&&n.push("pollenDestFile");var i=n.join(" ");return r.a.createElement("div",{className:i,key:a,onClick:this.onClickFile.bind(this,a)},t)}},{key:"renderEntryList",value:function(e,t){var n=this;return t.map(function(t){return t.endsWith("/")?n.renderFolder(e,t):n.renderFile(e,t)})}},{key:"render",value:function(){var e=this.state.entries.get("/"),t=this.renderEntryList("/",e);return t.isEmpty()&&(t="No files"),r.a.createElement("div",{id:"NavEntries"},t)}},{key:"fetchFileList",value:function(){var e=Object(f.a)(p.a.mark(function e(t){var n,a,r,i,o,s;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_(t);case 3:n=e.sent,e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(0),ee("Couldn't fetch files under ".concat(t,": ").concat(e.t0)),e.abrupt("return");case 11:if(0===(a=n.data.errno)){e.next=16;break}return ee("Error occurred on folder ".concat(t,": errno = ").concat(a)),e.abrupt("return");case 16:if(!("items"in n.data)){e.next=26;break}console.log("set ".concat(t," in the entries map")),r=Object(I.a)(n.data.items),i=r.filter(function(e){return e.endsWith("/")}),o=r.filterNot(function(e){return e.endsWith("/")}),r=i.concat(o),s=this.state.entries.set(t,r),this.setState({entries:s}),e.next=28;break;case 26:return ee("".concat(t," is not a folder")),e.abrupt("return");case 28:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.fetchFileList("/")}}]),t}(a.Component),ae=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{id:"Navigation"},r.a.createElement(te,null),r.a.createElement(ne,{onClickFile:this.props.onClickFile}))}}]),t}(a.Component),re=n(4),ie=n(35),oe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={location:null,loading:!0},n.onClickViewColumn=function(){return n.props.onClickDirection("vertical")},n.onClickViewRow=function(){return n.props.onClickDirection("horizontal")},n.onClickRefresh=n.onClickRefresh.bind(Object(re.a)(Object(re.a)(n))),n.onLoad=n.onLoad.bind(Object(re.a)(Object(re.a)(n))),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"onLoad",value:function(){var e=this;if(this.iframe){console.log("Install select handler in iframe");var t=this.iframe.contentWindow;t.addEventListener("mouseup",function(n){var a=t.getSelection().toString();e.props.onTextSelected(a||!1)})}this.setState({loading:!1})}},{key:"onClickRefresh",value:function(){var e=this;if(this.iframe){this.setState({loading:!0});var t=this.props.location;Q(t).then(function(){e.iframe.contentWindow.location.reload(!0)}).catch(function(e){ee("Failed to refresh ".concat(t))})}}},{key:"reload",value:function(){if(this.iframe)try{this.setState({loading:!0}),this.iframe.contentWindow.location.reload(!0)}catch(e){console.warn("Failed to reload, likely caused by same-origin policy"),this.iframe.src+=""}}},{key:"fetchLocation",value:function(){var e=Object(f.a)(p.a.mark(function e(t){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,Q(t);case 3:n=e.sent,this.setState({location:n.data.location}),0!==n.data.errno&&console.error("Render failed on ".concat(t));case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e){e.path!==this.props.path&&(this.setState({location:null}),this.fetchLocation(this.props.path)),this.iframe&&(this.iframe.onload=this.onLoad)}},{key:"componentDidMount",value:function(){this.fetchLocation(this.props.path)}},{key:"renderHeader",value:function(e){e||(e="Loading...");var t=this.state.loading?"spin":"";return r.a.createElement("div",{id:"PreviewHeader"},r.a.createElement("span",{id:"PreviewPath"},e),r.a.createElement(W,{className:"clickable ".concat(t),onClick:this.onClickRefresh}),r.a.createElement(L,{className:"clickable",onClick:this.onClickViewRow}),r.a.createElement(V,{className:"clickable",onClick:this.onClickViewColumn}))}},{key:"renderIframe",value:function(){var e=this;if(!this.state.location)return r.a.createElement("div",{className:"Loading"});var t="".concat(G,"/").concat(this.state.location);return r.a.createElement("div",{className:"previewIframe"},r.a.createElement("iframe",{className:"preview",src:t,title:"preview",ref:function(t){return e.iframe=t}}))}},{key:"render",value:function(){return r.a.createElement("div",{id:"PreviewArea"},this.renderHeader(this.state.location),this.renderIframe())}}]),t}(a.Component),se=n(2),ce=n.n(se),le=n(24),ue=(n(18),n(76),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).editor=null,n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(f.a)(p.a.mark(function e(){var t,a,r,i,o,s,c,l,u,h,d,f,v,m,g,k,j,b,y;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.props,a=t.events,r=t.options,i=t.height,o=t.width,s=t.value,this.editor=ce.a.fromTextArea(this.textarea,r),c=Object.entries(a),l=0;l<c.length;l++)u=c[l],h=Object(le.a)(u,2),d=h[0],f=h[1],this.editor.on(d,f);if(this.editor.setValue(s||""),this.editor.setSize(o,i),!(v=ce.a.findModeByName(r.mode))||!v.mode){e.next=11;break}return e.next=11,n(78)("./".concat(v.mode,"/").concat(v.mode,".js"));case 11:for(v&&(r.mode=v.mime),m=Object.entries(r),g=0;g<m.length;g++)k=m[g],j=Object(le.a)(k,2),b=j[0],y=j[1],this.editor.setOption(b,y);this.editor.refresh();case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.editor&&this.editor.toTextArea()}},{key:"render",value:function(){var e=this;return r.a.createElement("textarea",{ref:function(t){return e.textarea=t}})}}]),t}(a.Component));ue.defaultProps={value:"",options:{},events:{},width:"100%",height:"100%"};var he=n(37);function de(e){if(0!==e.braceCount||0!==e.blockBraceCount)throw new Error("pop context, but current context has braces not closed");var t=e.context.pop(),n=t.token,a=t.braceCount,r=t.blockBraceCount;e.token=n,e.braceCount=a,e.blockBraceCount=r}function pe(e,t){var n=function(e,t,n){return{token:e,braceCount:t,blockBraceCount:n}}(e.token,e.braceCount,e.blockBraceCount);e.context.push(n),e.token=t,e.braceCount=0,e.blockBraceCount=0}ce.a.registerHelper("syntaxCheck","pollen",function(e,t){var n=e.getStateAfter(t,!0);return 0===n.braceCount&&0===n.blockBraceCount}),ce.a.registerHelper("getScope","pollen",function(e,t){return e.getTokenAt(t).state.token.name}),ce.a.registerHelper("getTagPath","pollen",function(e,t){return e.getTokenAt(t).state.tagStack}),ce.a.defineMode("pollen",function(e){var t=e["command-char"]||"\u25ca",n="[^ \\n(){}\\[\\]\",'`;#|\\\\".concat(t,"]+"),a=new RegExp(n),r=new RegExp("[^".concat(t,"]"));function i(e){var t=!0,n=!1,a=void 0;try{for(var r,i=e.tagStack[Symbol.iterator]();!(t=(r=i.next()).done);t=!0)if(";"===r.value)return!0}catch(o){n=!0,a=o}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}return!1}function o(e,t){return e.eatSpace()?null:(e.eatWhile(r),null)}function s(e,t){var n=e.next();return"{"===n?(t.braceCount+=1,"open brace"):"}"===n?t.braceCount>0?(t.braceCount-=1,0===t.braceCount&&(de(t),";"===t.tagStack.pop())?(t.inComment=i(t),"comment"):"close brace"):"brace":(" "===n||e.eatSpace()||e.eatWhile(/[^\s{}]/),null)}function c(e,t){return e.match(/\|\{/)?(t.blockBraceCount+=1,"open blockBrace"):e.match(/\}\|/)?t.blockBraceCount>0?(t.blockBraceCount-=1,0===t.blockBraceCount&&(de(t),";"===t.tagStack.pop())?(t.inComment=i(t),"comment"):"close blockBrace"):"blockBrace":(e.eatWhile(/[^\s{}]/)||e.next(),null)}function l(e,n){if(e.peek()===t)throw new Error("the caller of inCmd must eat cmdChar");if(e.eat(";"))return e.match(/\|?\{/,!1)?(n.tagStack.push(";"),n.inComment=!0):(e.skipToEnd(),de(n)),"comment";if(e.match(a)){var r=e.current().substring(1);return n.tagStack.push(r),"keyword"}var i=e.peek();return"["===i?(pe(n,u),null):"{"===i?(n.token=s,null):e.match(/\|\{/,!1)?(n.token=c,null):(de(n),n.tagStack.pop(),null)}function u(e,t){var n=e.next();return"["===n?"open bracket":"]"===n?(de(t),"close bracket"):null}return{token:function(e,n){if(e.eat(t)){pe(n,l);var a=l(e,n);return n.inComment?"comment":a}var r=n.token(e,n);return n.inComment?"comment":r},startState:function(){return{context:[],token:o,braceCount:0,blockBraceCount:0,tagStack:[],inComment:!1}},copyState:function(e){var t=Object(he.a)({},e);return t.context=e.context.slice(),t.tagStack=e.tagStack.slice(),t}}}),ce.a.defineMIME("text/x-pollen","pollen");var fe={1:"Operation not permitted",2:"No such file or directory",17:"File exists",20:"Not a directory",21:"Is a directory",30:"Read-only file system",116:"The file has been changed on disk"};function ve(e){return r.a.createElement("div",{id:"EditorHeader"},r.a.createElement("span",{id:"EditorPath"},e.path),e.children)}var me=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"renderTagContext",value:function(){var e,t=this.props.tagStack||[];this.props.lastTagObj?(e=t.slice(0,t.length-1)).push(""):e=t.slice();var n=e.join(" > ");return r.a.createElement("span",{id:"tagContext"},n)}},{key:"renderSignature",value:function(e){var t,n=e.name;if("variable"===e.kind){var a=e.type,i=e.value;i=i||"unknown value",a=a||"unknown type",t="".concat(n,": ").concat(a," (").concat(i,")")}else{for(var o=[],s="",c=0;c<e.arity;++c)o.push("arg".concat(c));e["arity-at-least"]&&(s=". rest"),t="(".concat(n," ").concat(o," ").concat(s,")")}return r.a.createElement("span",{id:"tagSignature"},t)}},{key:"render",value:function(){var e;return this.props.lastTagObj&&(e=this.renderSignature(this.props.lastTagObj)),r.a.createElement("div",{id:"EditorFooter"},this.renderTagContext(),e)}}]),t}(a.Component),ge=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={tags:[]},n.initContents=null,n.mtime=0,n.pendingSaveTimer=null,n.savedGeneration=-1,n.pendingSaveAction=null,n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"findMode",value:function(e){var t="pollen";if(!e)return t;var n={pm:"pollen",rkt:"scheme"},a=e.split("."),r=a.pop();if("pp"!==r&&"p"!==r||(r=a.pop()),n[r])return n[r];var i=ce.a.findModeByExtension(r);return i&&i.name&&(t=i.name),t}},{key:"getCommandChar",value:function(){var e=this.state.tags["default-command-char"];return e?e.value:"\u25ca"}},{key:"getScope",value:function(e,t){if(!ce.a.getScope)return null;var n=e.doc.getMode(),a=ce.a.getScope[n.name];return a?a(e,t):null}},{key:"insertCommandCharHandler",value:function(e){var t=e.getCursor(),n=t.line,a=t.ch;a=a-1>=0?a-1:a;var r=e.getLineHandle(n).text.charAt(a),i=this.getCommandChar();r!==i?e.replaceSelection(i):e.replaceRange("@",{line:n,ch:a},{line:n,ch:a+1})}},{key:"insertBraceHandler",value:function(e){var t=e.getCursor(),n=t.line,a=t.ch;(a=a-1>=0?a-1:a,"inTopText"!==this.getScope(e,{line:n,ch:a}))?("|"===e.getLineHandle(n).text.charAt(a)?e.replaceSelection("{}|"):e.replaceSelection("{}"),e.setCursor({line:n,ch:a+2})):e.replaceSelection("{")}},{key:"insertBracketHandler",value:function(e){var t=e.getCursor(),n=t.line,a=t.ch;a=a-1>=0?a-1:a;var r="[";"inCmd"===this.getScope(e,{line:n,ch:a})&&(r="[]"),e.replaceSelection(r)}},{key:"backSpaceHandler",value:function(e){var t=e.getCursor(),n=t.line,a=t.ch;if(0===a)return ce.a.Pass;a-=1;var r=e.getLineHandle(n).text,i=r.charAt(a);if("}"===i)return e.getTokenAt({line:n,ch:a+1}).type?(e.setCursor({line:n,ch:a}),null):ce.a.Pass;if("{"===i&&"}"===r.charAt(a+1)){var o=a,s=2;return"|"===r.charAt(a-1)&&"|"===r.charAt(a+2)&&(o-=1,s=4),e.replaceRange("",{line:n,ch:o},{line:n,ch:o+s}),null}return"|"===i&&"}"===r.charAt(a-1)&&e.getTokenAt({line:n,ch:a}).type?(e.setCursor({line:n,ch:a-1}),null):ce.a.Pass}},{key:"tabHandler",value:function(e){if(e.somethingSelected())e.indentSelection("add");else if(e.getOption("indentWithTabs"))e.replaceSelection("\t");else{var t=Array(e.getOption("indentUnit")+1).join(" ");e.replaceSelection(t)}}},{key:"saveToDisk",value:function(){var e=Object(f.a)(p.a.mark(function e(t,n){var a,r,i,o,s,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isClean(this.savedGeneration)){e.next=2;break}return e.abrupt("return",!0);case 2:return a=n.changeGeneration(),r=n.getValue(),e.next=6,Z(t,r,this.mtime);case 6:if(0===(i=e.sent).data.errno){e.next=14;break}return(o=i.data.errno)in fe?(c=fe[o],s="Failed to save ".concat(t,": ").concat(c)):s=i.data.message,ee(s),e.abrupt("return",!1);case 14:this.mtime=i.data.message;case 15:return this.savedGeneration=a,e.abrupt("return",!0);case 17:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"saveAndCheckSyntax",value:function(){var e=Object(f.a)(p.a.mark(function e(t,n){var a,r,i,o,s;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=!1,e.prev=1,e.next=4,this.saveToDisk(t,n);case 4:a=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),ee("Failed to save ".concat(t,": ").concat(e.t0,". Server might have terminated."));case 10:if(a){e.next=12;break}return e.abrupt("return",!1);case 12:return r=n.doc,i=r.getMode(),o=ce.a.syntaxCheck[i.name],s=!0,o&&(s=o(n,r.lastLine())),this.props.onSyntaxCheck(s),e.abrupt("return",!0);case 19:case"end":return e.stop()}},e,this,[[1,7]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"onChanges",value:function(e,t){var n=this;e&&(this.savedGeneration<0?this.savedGeneration=t.changeGeneration():(window.clearTimeout(this.pendingSaveTimer),this.pendingSaveAction=Object(f.a)(p.a.mark(function a(){return p.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:n.saveAndCheckSyntax(e,t)&&(n.pendingSaveAction=null);case 2:case"end":return a.stop()}},a,this)})),this.pendingSaveTimer=window.setTimeout(this.pendingSaveAction,1e3)))}},{key:"refresh",value:function(){this.editor&&this.editor.editor.refresh()}},{key:"markSyncText",value:function(e){var t=this;if(this.editor){this.clearSyncText();var n=[],a=this.editor.editor.getDoc();this.editor.editor.eachLine(function(t){var r=t.text,i=new RegExp(e,"i"),o=r.match(i);if(o){var s=a.getLineNumber(t),c={line:s,ch:o.index},l={line:s,ch:o.index+e.length};n.push({fromPos:c,toPos:l})}}),0!==n.length&&(n.forEach(function(e){var n=a.markText(e.fromPos,e.toPos,{className:"previewTextFound"});t.syncMarkers.push(n)}),this.editor.editor.scrollIntoView(n[0].fromPos))}}},{key:"clearSyncText",value:function(){this.syncMarkers&&this.syncMarkers.forEach(function(e){e.clear()}),this.syncMarkers=[]}},{key:"getTag",value:function(e){return e&&e.startsWith(this.getCommandChar())&&(e=e.substring(1)),this.state.tags[e]||null}},{key:"render",value:function(){var e=this;if(null===this.initContents)return r.a.createElement("p",null,"Loading...");var t=this.props.path,n=this.findMode(t),a={mode:n,lineNumbers:!0,lineWrapping:!0,extraKeys:{"'@'":this.insertCommandCharHandler.bind(this),"'{'":this.insertBraceHandler.bind(this),"'['":this.insertBracketHandler.bind(this),Backspace:this.backSpaceHandler.bind(this),Tab:this.tabHandler.bind(this)}},i={changes:this.onChanges.bind(this,t)};return n.includes("pollen")?i.cursorActivity=this.props.onCursorActivity:console.warn("cursorActivity is available only for pollen mode"),r.a.createElement("div",{id:"EditorBody"},r.a.createElement(ue,{value:this.initContents,ref:function(t){return e.editor=t},options:a,events:i}))}},{key:"_loadContents",value:function(){var e=Object(f.a)(p.a.mark(function e(t){var n,a,r,i,o,s,c,l,u,h,d,f,v,m,g,k,j,b,y;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=_(t),o=J(t),s=K(t),e.next=6,i;case 6:return n=e.sent,e.next=9,o;case 9:return a=e.sent,e.next=12,s;case 12:r=e.sent,e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(0),ee("Error occurs when sending requests: ".concat(e.t0)),e.abrupt("return");case 19:if(!(0===n.data.errno&&"contents"in n.data)){e.next=25;break}this.initContents=n.data.contents,"mtime"in n.data||$("Consistency check is unavailable. Other clients can silently overwrite this document."),this.mtime=n.data.mtime||0,e.next=27;break;case 25:return ee("".concat(t," contents are not available")),e.abrupt("return");case 27:if(c={},0!==r.data.errno){e.next=48;break}for(l=!0,u=!1,h=void 0,e.prev=32,d=r.data.tags[Symbol.iterator]();!(l=(f=d.next()).done);l=!0)v=f.value,c[v.name]=v;e.next=40;break;case 36:e.prev=36,e.t1=e.catch(32),u=!0,h=e.t1;case 40:e.prev=40,e.prev=41,l||null==d.return||d.return();case 43:if(e.prev=43,!u){e.next=46;break}throw h;case 46:return e.finish(43);case 47:return e.finish(40);case 48:if(0!==a.data.errno){e.next=68;break}for(m=!0,g=!1,k=void 0,e.prev=52,j=a.data.tags[Symbol.iterator]();!(m=(b=j.next()).done);m=!0)y=b.value,c[y.name]=y;e.next=60;break;case 56:e.prev=56,e.t2=e.catch(52),g=!0,k=e.t2;case 60:e.prev=60,e.prev=61,m||null==j.return||j.return();case 63:if(e.prev=63,!g){e.next=66;break}throw k;case 66:return e.finish(63);case 67:return e.finish(60);case 68:if(0===r.data.errno||0===a.data.errno){e.next=71;break}return ee("".concat(t," config and tags are not available")),e.abrupt("return");case 71:this.setState({tags:c});case 72:case"end":return e.stop()}},e,this,[[0,15],[32,36,40,48],[41,,43,47],[52,56,60,68],[61,,63,67]])}));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this,t=this.props.path;this._loadContents(t).then(function(e){console.log("Successfully fetched ".concat(t))}).catch(function(e){ee("Failed to load ".concat(t,": ").concat(e))}),window.onbeforeunload=function(t){e.pendingSaveAction&&(window.clearTimeout(e.pendingSaveTimer),e.pendingSaveAction(),t.preventDefault(),t.returnValue="unsaved changes")}}},{key:"componentWillUnmount",value:function(){var e=Object(f.a)(p.a.mark(function e(){return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window.clearTimeout(this.cursorTokenTimer),!this.pendingSaveAction){e.next=5;break}return window.clearTimeout(this.pendingSaveTimer),e.next=5,this.pendingSaveAction();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(a.Component),ke=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={splitDirection:"vertical",dragging:!1,tagStack:[]},n.onDragStarted=n.onDragStarted.bind(Object(re.a)(Object(re.a)(n))),n.onDragFinished=n.onDragFinished.bind(Object(re.a)(Object(re.a)(n))),n.onClickDirection=n.onClickDirection.bind(Object(re.a)(Object(re.a)(n))),n.onPreviewSelected=n.onPreviewSelected.bind(Object(re.a)(Object(re.a)(n))),n.onSyntaxCheck=n.onSyntaxCheck.bind(Object(re.a)(Object(re.a)(n))),n.onCursorActivity=n.onCursorActivity.bind(Object(re.a)(Object(re.a)(n))),n.cursorTokenTimer=null,n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"onClickDirection",value:function(e){this.state.splitDirection!==e&&this.setState({splitDirection:e})}},{key:"onDragStarted",value:function(){this.setState({dragging:!0})}},{key:"onDragFinished",value:function(){this.setState({dragging:!1}),this.editorBody&&this.editorBody.refresh()}},{key:"onPreviewSelected",value:function(e){this.editorBody&&(!1===e&&this.editorBody.clearSyncText(),this.editorBody.markSyncText(e))}},{key:"onSyntaxCheck",value:function(e){!0===e?this.previewArea.reload():console.log("Syntax error. No preview reload")}},{key:"onCursorActivity",value:function(e){var t=this;window.clearTimeout(this.cursorTokenTimer),this.cursorTokenTimer=window.setTimeout(function(){var n=e.doc.getMode(),a=ce.a.getTagPath[n.name],r=e.getCursor(),i=a(e,r);t.state.tagStack.join("")!==i.join("")&&t.setState({tagStack:i})},1e3)}},{key:"componentDidUpdate",value:function(e,t){var n=!1;n|=t.dragging!==this.state.dragging,n|=t.splitDirection!==this.state.splitDirection,(n|=e.fullscreen!==this.props.fullscreen)&&this.editorBody&&(console.log("refresh the editor for window change"),this.editorBody.refresh())}},{key:"renderEditingArea",value:function(){var e,t=this,n="";if(this.state.dragging&&(n="hidePointerEvents"),this.editorBody&&this.state.tagStack.length){var a=this.state.tagStack[this.state.tagStack.length-1];e=this.editorBody.getTag(a)}return r.a.createElement("div",{id:"EditingArea",className:n},r.a.createElement(ve,{path:this.props.path},r.a.createElement(R,{className:"clickable",onClick:this.props.onClickFullscreen})),r.a.createElement(ge,{path:this.props.path,key:this.props.path,onSyntaxCheck:this.onSyntaxCheck,onCursorActivity:this.onCursorActivity,ref:function(e){return t.editorBody=e}}),r.a.createElement(me,{tagStack:this.state.tagStack,lastTagObj:e}))}},{key:"renderPreviewArea",value:function(){var e=this,t="";this.state.dragging&&(t="hidePointerEvents");return r.a.createElement("div",{className:t,style:{width:"100%",height:"100%"}},r.a.createElement(oe,{path:this.props.path,ref:function(t){return e.previewArea=t},onClickDirection:this.onClickDirection,onTextSelected:this.onPreviewSelected}))}},{key:"render",value:function(){var e="nonFullscreen",t=this.state.splitDirection,n="50%";return this.props.fullscreen&&(e="fullscreen",n="0"),r.a.createElement("div",{id:"Editor",className:e},r.a.createElement(ie.a,{split:t,primary:"second",paneStyle:{overflow:"auto"},maxSize:-200,onDragFinished:this.onDragFinished,onDragStarted:this.onDragStarted,size:n},this.renderEditingArea(),this.renderPreviewArea()))}}]),t}(a.Component),je=n(36),be=n.n(je);n(79);function ye(e){return r.a.createElement("div",{id:"Splash"},r.a.createElement("img",{src:be.a,alt:"Pollen-rock-logo"}))}var Ce=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={openFile:null,fullscreen:!1},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"onClickFullscreen",value:function(){this.setState(function(e,t){return{fullscreen:!e.fullscreen}})}},{key:"renderNavigation",value:function(){var e=this;return r.a.createElement(ae,{onClickFile:function(t){return e.setState({openFile:t})}})}},{key:"renderSplash",value:function(){return r.a.createElement("div",{id:"App"},this.renderNavigation(),r.a.createElement(ye,null),r.a.createElement(Y,null))}},{key:"renderEditor",value:function(e,t){var n,a="fullscreen";return t||(n=this.renderNavigation(),a=""),r.a.createElement("div",{id:"App",className:a},n,r.a.createElement(ke,{path:e,fullscreen:this.state.fullscreen,onClickFullscreen:this.onClickFullscreen.bind(this)}),r.a.createElement(Y,null))}},{key:"render",value:function(){if(this.state.openFile){var e=this.state.fullscreen,t=this.state.openFile;return this.renderEditor(t,e)}return this.renderSplash()}}]),t}(a.Component);n(81),n(83),n(85);o.a.render(r.a.createElement(Ce,null),document.getElementById("root"))}},[[38,122,113]]]);
//# sourceMappingURL=main.d1d5ee25.chunk.js.map